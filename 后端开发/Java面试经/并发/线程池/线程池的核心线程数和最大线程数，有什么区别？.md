线程池中的 **核心线程数** 和 **最大线程数** 是两个控制线程池行为的关键参数，它们的作用和区别如下：

### 1. **核心线程数（corePoolSize）**

- **定义**：核心线程数指的是线程池中保持存活的最小线程数，即使这些线程处于空闲状态（没有执行任何任务），线程池也会保持至少有 `corePoolSize` 个线程存活。
  
- **特点**：
  - 在没有任务执行时，核心线程不会被销毁，会一直保持活动状态。
  - 当有新任务提交时，如果当前活跃的线程数小于 `corePoolSize`，即使任务队列中有任务等待，线程池也会优先创建新的核心线程来执行任务，而不是将任务放入队列。
  
- **适用场景**：核心线程数适合处理常规负载，能够确保线程池在有任务的情况下快速响应并处理任务，而不需要每次都创建新线程。

### 2. **最大线程数（maximumPoolSize）**

- **定义**：最大线程数是线程池中允许存在的最大线程数量。当任务量很大，线程池中的活跃线程数超过 `corePoolSize`，并且任务队列已满时，线程池会创建额外的线程，直到线程总数达到 `maximumPoolSize`。
  
- **特点**：
  - 当核心线程都在忙碌，且任务队列已满时，线程池会创建非核心线程来执行任务。非核心线程一旦空闲且超过 `keepAliveTime` 设置的时间，则会被回收。
  - 非核心线程的存在是为了应对短期的突发任务需求，提升线程池的并发能力。
  - 当线程池中线程数达到 `maximumPoolSize` 时，如果继续有新任务提交，而任务队列又满了，则根据拒绝策略处理（如抛出异常、丢弃任务等）。

- **适用场景**：最大线程数用于处理高峰期的突发任务。通过扩展线程池的线程数，可以临时应对超出常规负载的情况，避免任务积压。

### 3. **核心线程数与最大线程数的区别**

| 参数                 | 核心线程数（corePoolSize）                              | 最大线程数（maximumPoolSize）                                |
| -------------------- | ------------------------------------------------------- | ------------------------------------------------------------ |
| **存活机制**         | 核心线程始终存活，即使空闲也不会销毁。                  | 非核心线程会根据 `keepAliveTime` 设定的空闲时间自动回收。    |
| **线程创建时机**     | 新任务提交时，先创建核心线程，直到达到 `corePoolSize`。 | 当核心线程全部忙碌且任务队列已满时，才会创建额外的非核心线程。 |
| **处理任务的优先级** | 核心线程用于处理常规的、长期负载。                      | 非核心线程用于处理突发的高负载任务，提升并发能力。           |
| **最大线程数**       | 线程池中允许存在的最小线程数。                          | 线程池中允许存在的最大线程数。                               |

### 4. **工作流程示例**

假设你配置了如下线程池：
- 核心线程数（`corePoolSize`）：8
- 最大线程数（`maximumPoolSize`）：16
- 任务队列：容量为 10 的 `ArrayBlockingQueue`
- 非核心线程空闲回收时间（`keepAliveTime`）：60秒

**线程池的工作流程**：

1. **最初提交任务**：当新任务提交时，线程池会优先创建 **核心线程** 来处理任务，直到活跃线程数达到 **8**（`corePoolSize`）。这些线程即使处理完任务后变为空闲状态，也不会被销毁。
   
2. **超过核心线程数的任务**：当核心线程都在处理任务时，新的任务会进入任务队列。如果队列还没有满，任务会被放入队列等待处理。

3. **任务队列满了**：如果任务队列已满，且还有新的任务提交，此时线程池会创建 **非核心线程** 来执行这些任务，直到线程总数达到 **16**（`maximumPoolSize`）。

4. **超过最大线程数的任务**：如果线程总数已达到 `maximumPoolSize`，且任务队列已满，新的任务提交时将触发 **拒绝策略**，可能抛出异常、丢弃任务或让提交任务的线程执行任务。

5. **任务处理完毕后**：当任务完成后，非核心线程如果空闲超过 `keepAliveTime`，线程池会销毁这些线程，只保留 **核心线程**（`corePoolSize`），以节省资源。

### 5. **线程池配置建议**

- **核心线程数（corePoolSize）**：适合设置为服务器 CPU 核心数的倍数，常见配置是 `CPU核心数 + 1` 或 `2倍CPU核心数`，以确保任务的常规负载处理效率。
- **最大线程数（maximumPoolSize）**：一般为核心线程数的 `2倍到3倍`，根据任务的突发情况来配置，用于应对高峰期的任务量。
- **队列大小**：根据实际任务的执行时间和负载设置，如果任务处理较快，可以选择较小的队列，否则可以适当增大队列以防止线程池频繁扩展线程。

### 6. **总结**

- **核心线程数** 是线程池保持的最低线程数量，即使线程空闲也不会销毁，适合处理日常的负载。
- **最大线程数** 是线程池在高峰期为了处理更多任务而创建的额外线程，当任务高峰过后，这些非核心线程会被销毁以节省资源。

在实际场景中，配置这两个参数时要考虑任务的特点（CPU密集型或I/O密集型）、系统资源（CPU和内存），以及任务的并发和突发需求。